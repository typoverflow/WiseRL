algorithm:
  class: OPPO
  z_dim: 16
  seq_len: 20
  pref_loss_ratio: 0.5
  znorm_loss_ratio: 0.1
  warmup_steps: 100000

checkpoint: null
seed: 2
name: default
debug: false
device: null
wandb:
  activate: true
  entity: zhuyj
  project: oppo

env: hopper-medium-expert-v2
env_kwargs:
env_wrapper:
env_wrapper_kwargs:

optim:
  default:
    class: AdamW
    lr: 0.0001
  policy:
    class: AdamW
    lr: 0.0001
    weight_decay: 0.0001
  encoder:
    class: AdamW
    lr: 0.0001
    weight_decay: 0.0001
  zstar:
    class: AdamW
    lr: 0.001
    weight_decay: 0.0001


network:
  encoder:
    embed_dim: 128
    num_layers: 3
    num_heads: 2
    dropout: 0.1
  policy:
    embed_dim: 128
    num_layers: 3
    num_heads: 1
    dropout: 0.1


dataset:
  - class: OPPODataset
    env: hopper-medium-expert-v2
    batch_size: 128 # [64, 128]
    seq_len: 20
    foresee: 200

dataloader:
  num_workers: 0
  batch_size: null

trainer:
  env_freq: null
  total_steps: 100000
  log_freq: 100
  profile_freq: 100
  eval_freq: 100   # don't do eval

eval:
  function: eval_offline_with_history_input
  num_ep: 10
  deterministic: true

schedulers:

processor: null
